(()=>{"use strict";function e(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,o=new Array(t);i<t;i++)o[i]=e[i];return o}function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(t)||function(t,i){if(t){if("string"==typeof t)return e(t,i);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?e(t,i):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function n(e,t,i){return t&&o(e.prototype,t),i&&o(e,i),e}function r(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,o)}return i}function l(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){r(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}var s=function(e){var t=e.$doms,i=e.data,o=void 0===i?null:i;if(o&&Object.keys(o).length)dataLayer.push(l(l({},o),{},{site_build:"rome"}));else{(t&&t.length?t:$(".only-for-datalayer-tracking")).on("click",(function(){var e=$(this);if(!e.hasClass("swiper-button-disabled")){var t=l({},e.data("datalayer"));if(e.hasClass("swiper-custom-prev")||e.hasClass("swiper-custom-next")){var i=e.attr("aria-controls"),o=$("#".concat(i)),n=o.parent(),r=[];if(n.hasClass("js-6-4-container")){var a=n.parent().find(".js-6-4-pagination"),s=+a.html().slice(-2),c=+a.html().slice(0,2);e.hasClass("swiper-custom-prev")?--c<1&&(c=s):e.hasClass("swiper-custom-next")&&++c>s&&(c=1);var v=(r=[c]).join();t.event_label+="|".concat(v),dataLayer.push(l(l({},t),{},{site_build:"rome"}))}else setTimeout((function(){for(var e=o.find(".swiper-slide-active"),i=0;i<e.length;i++)r.push(+$(e[i]).attr("aria-label").split("/")[0]);var n=r.join();t.event_label+="|".concat(n),dataLayer.push(l(l({},t),{},{site_build:"rome"}))}),0)}else dataLayer.push(l(l({},t),{},{site_build:"rome"}))}}))}},c=function(){if(dataLayer&&dataLayer.length)for(var e=0;e<dataLayer.length;e++){var t=dataLayer[e];if("function"!=typeof t)for(var i=Object.keys(t),o=0;o<i.length;o++){if("page_name"==i[o])return t}}};var v=function(){function e(){i(this,e),this.rootElem=void 0,this.src="",this.dataLayer=void 0,this.extraParams={},this.elems={},this.aboutToClose=!1}return n(e,[{key:"template",value:function(){return"\n            <div class='video-overlay'>\n                <button class='close-overlay-btn' type='button'>\n                    <div class='close-overlay-btn-icon'></div>\n                </button>\n\n                <div class='overlay-video-wrapper'>\n                    <video class='overlay-video' controls playsinline>\n                        <source src='".concat(this.src,"'>\n                        <div class='preview-video-alt'>Your video doesn't support video</div>\n                    </video>\n                </div>\n            </div>\n        ")}},{key:"moduleName",value:function(){return this.extraParams.moduleName||""}},{key:"moduleTitle",value:function(){return this.extraParams.moduleTitle||""}},{key:"moduleNameAndTitle",value:function(){var e=this.moduleName(),t=this.moduleTitle();return""!==t&&(e+="|".concat(t)),e}},{key:"init",value:function(){var e,t,i=this;this.rootElem=(e=this.template(),(t=document.createElement("div")).innerHTML=e,t.querySelector("*"));var o=this.rootElem,n=this.elems;n.closeOverlayBtn=o.querySelector(".close-overlay-btn"),n.overlayVideo=o.querySelector(".overlay-video"),n.closeOverlayBtn.addEventListener("click",(function(){var e;(i.aboutToClose=!0,i.dataLayer)&&s({data:{event:"video",event_category:(null===(e=c())||void 0===e?void 0:e.page_name)||"",event_action:"video_close: ".concat(i.moduleNameAndTitle()),event_label:i.src}});i.close()})),n.overlayVideo.addEventListener("play",(function(){var e;s({data:{event:"video",event_category:(null===(e=c())||void 0===e?void 0:e.page_name)||"",event_action:"video_play: ".concat(i.moduleNameAndTitle()),event_label:i.src}})})),n.overlayVideo.addEventListener("pause",(function(){var e,t;i.aboutToClose?i.aboutToClose=!1:n.overlayVideo.ended?s({data:{event:"video",event_category:(null===(e=c())||void 0===e?void 0:e.page_name)||"",event_action:"video_complete: ".concat(i.moduleNameAndTitle()),event_label:i.src}}):s({data:{event:"video",event_category:(null===(t=c())||void 0===t?void 0:t.page_name)||"",event_action:"video_pause: ".concat(i.moduleNameAndTitle()),event_label:i.src}})}))}},{key:"open",value:function(){t(document.body.children).includes(this.rootElem)||(this.init(),document.body.appendChild(this.rootElem),this.elems.overlayVideo.play(),this.setBodyScrollable(!1))}},{key:"close",value:function(){t(document.body.children).includes(this.rootElem)&&(document.body.removeChild(this.rootElem),this.rootElem=void 0,this.elems={},this.setBodyScrollable(!0))}},{key:"setBodyScrollable",value:function(e){e?(document.body.style.overflowY="",document.body.style.touchAction=""):(document.body.style.overflowY="hidden",document.body.style.touchAction="none")}}],[{key:"create",value:function(t,i,o){var n=new e;return n.src=t,i&&(n.dataLayer=i),o&&(n.extraParams=o),n}}]),e}(),u=function(e,t){if(!$(e).length)return{hasSrc:!1};var i,o,n=$(e).data(),r=n.desktopPreview,a=n.desktopFull,l=n.mobilePreview,s=n.mobileFull;return t?(i=r||l||a||s,o=a||s||r||l):(i=l||r||s||a,o=s||a||l||r),{preview:i,full:o,hasSrc:!!i}};!function(){function e(e,t){e.style.display=t?"":"none"}function o(e){var t=.8*window.innerHeight,i=function(e,t,i){var o=(i-e)/(t-e);return o>1?1:o<0?0:o}(t-200,t,e.getBoundingClientRect().top);e.style.transform="translateY(".concat(30*i,"px)"),e.style.opacity="".concat(1-i)}function r(){return window.innerWidth>=992}var a=function(){function e(){i(this,e),this.rootElem=void 0,this.elems={},this.contentType="image",this.videoController=void 0,this.videoSrc={},this.isDesktop=!0,this.oldIsDisktop=!0}return n(e,[{key:"init",value:function(){var e=this;this.isDesktop=r(),this.oldIsDisktop=r();var t=this.rootElem,i=this.elems,n=t.getAttribute("data-content-type");"image"!==n&&"video"!==n&&(n="image"),this.contentType=n,"video"===this.contentType&&(this.initVideo(),i.videoController=t.querySelector(".video-controller"),this.videoController=l.create(i.videoController)),i.previewPlayBtn=t.querySelector(".preview-play-btn"),i.previewPauseBtn=t.querySelector(".preview-pause-btn"),i.wavePattern=t.querySelector(".wave-pattern"),i.quoteTextPart=t.querySelector(".quote-text-part"),document.addEventListener("scroll",(function(){o(i.quoteTextPart)})),o(i.quoteTextPart),i.previewPlayBtn&&i.previewPlayBtn.classList.add("btn"),i.previewPauseBtn&&i.previewPauseBtn.classList.add("btn"),window.addEventListener("resize",(function(){e.isDesktop=r(),e.isDesktop!==e.oldIsDisktop&&"video"===e.contentType&&(e.initVideo(),e.oldIsDisktop=e.isDesktop),e.setPattern()})),this.setPattern(),t._initiated=!0}},{key:"initVideo",value:function(){var e=this.rootElem.querySelector(".preview-video-wrapper");if(e){if(this.videoSrc=u(e,this.isDesktop),!this.videoSrc.hasSrc)return;var t=e.querySelector(".preview-video");if(t.getAttribute("src")===this.videoSrc.preview)return;t.setAttribute("src",this.videoSrc.preview),function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5;e&&e.addEventListener("timeupdate",(function(){e.currentTime>t&&(e.currentTime=0)}))}(t)}}},{key:"setPattern",value:function(){var e=this.rootElem,t=this.elems;if(this.isDesktop){var i=e.querySelector(".video-part").getBoundingClientRect(),o=i.width+128;t.wavePattern.style.width="".concat(o,"px"),t.wavePattern.style.left="".concat(i.left-64,"px")}else t.wavePattern.style.width="".concat(window.innerWidth,"px"),t.wavePattern.style.left="0"}}],[{key:"create",value:function(t){var i=new e;return i.rootElem=t,i.init(),i}}]),e}(),l=function(){function o(){i(this,o),this.rootElem=void 0,this.elems={},this.isPreviewPlaying=!0,this.featureQuoteVideoOverlay=void 0,this.videoSrc={},this.isDesktop=!0,this.oldIsDisktop=!0}return n(o,[{key:"init",value:function(){var e=this;this.isDesktop=r(),this.oldIsDisktop=r(),this.initVideo();var t=this.rootElem,i=this.elems;i.coverImage=t.querySelector(".cover-image"),i.previewVideo=t.querySelector(".preview-video"),i.previewPlayBtn=t.querySelector(".preview-play-btn"),i.previewPauseBtn=t.querySelector(".preview-pause-btn"),i.previewPauseBtnPauseIcon=t.querySelector(".preview-pause-btn-pause-icon"),i.previewPauseBtnPlayIcon=t.querySelector(".preview-pause-btn-play-icon"),i.previewPlayBtn&&i.previewPlayBtn.addEventListener("click",(function(){var t;s({data:{event:"video",event_category:(null===(t=c())||void 0===t?void 0:t.page_name)||"",event_action:"video_click",event_label:e.videoSrc.full||""}}),e.openOverlay()})),i.previewPauseBtn&&i.previewPauseBtn.addEventListener("click",(function(){var t,i;e.setPreviewPlaying(!e.isPreviewPlaying),i=e.isPreviewPlaying?"video_play":"video_pause",s({data:{event:"video",event_category:(null===(t=c())||void 0===t?void 0:t.page_name)||"",event_action:i,event_label:e.videoSrc.preview}})})),window.addEventListener("resize",(function(){e.isDesktop=r(),e.isDesktop!==e.oldIsDisktop&&(e.initVideo(),e.oldIsDisktop=e.isDesktop)})),t._initiated=!0}},{key:"initVideo",value:function(){var e=this.rootElem.querySelector(".preview-video-wrapper");e&&(this.videoSrc=u(e,this.isDesktop))}},{key:"openOverlay",value:function(){var e,i=this,o=t(document.querySelectorAll(".feature-quote")).find((function(e){return $.contains(e,i.rootElem)})).querySelector(".quote-content").textContent;this.featureQuoteVideoOverlay=v.create(this.videoSrc.full,{event:"video",event_category:(null===(e=c())||void 0===e?void 0:e.page_name)||"",event_action:"video_click",event_label:this.videoSrc.full||""},{moduleName:"feature_quote",moduleTitle:o}),this.videoSrc.hasSrc&&this.featureQuoteVideoOverlay.open()}},{key:"setPreviewPlaying",value:function(t){var i=this.elems;this.isPreviewPlaying=t,this.isPreviewPlaying?i.previewVideo.play():i.previewVideo.pause(),e(i.previewPauseBtnPauseIcon,this.isPreviewPlaying),e(i.previewPauseBtnPlayIcon,!this.isPreviewPlaying)}}],[{key:"create",value:function(e){var t=new o;return t.rootElem=e,t.init(),t}}]),o}();$((function(){t(document.querySelectorAll(".feature-quote")).filter((function(e){return!e._initiated})).forEach((function(e){a.create(e)}))}))}()})();